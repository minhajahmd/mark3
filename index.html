<!DOCTYPE html>
<html lang="en">

<head>
    <title>AR Interactive Product Catalog</title>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <link type="text/css" rel="stylesheet" href="style.css">
    <script src="https://aframe.io/releases/1.2.0/aframe.min.js"></script>
    <script src="https://cdn.jsdelivr.net/gh/AR-js-org/AR.js/aframe/build/aframe-ar.js"></script>
</head>

<body>
    <header>
        <h1>AR Interactive Product Catalog</h1>
    </header>

    <nav>
        <ul id="product-list">
            <!-- Product items will be dynamically inserted here -->
        </ul>
    </nav>

    <section id="product-details" class="hidden">
        <h2 id="product-name"></h2>
        <img id="product-image" alt="Product Image" style="width: 300px; height: 300px;">
        <p id="product-description"></p>
        <button id="view-in-ar-button">View in AR</button>
        <button id="back-button">Back to Catalog</button>
    </section>

    <!-- Color Selection UI -->
    <div id="color-options" class="hidden">
        <button id="color-green">Dark Green</button>
        <button id="color-black">Black</button>
        <button id="color-default">Blue</button>
    </div>

    <a-scene embedded arjs="sourceType: webcam;" style="display: none;">
        <a-assets>
            <a-asset-item id="model" src=""></a-asset-item>
        </a-assets>

        <a-marker preset="hiro">
            <a-entity id="modelEntity" gltf-model="#model" scale="1 1 1" position="0 0 0">
            </a-entity>
        </a-marker>

        <a-camera-static></a-camera-static>
    </a-scene>

    <script>
        const products = [
            {
                id: 1,
                name: 'Velvet Chair',
                image: 'chair.jpg',
                description: 'Explore our stylish chair, perfect for any living space!',
                model: 'chair.glb'
            },
            {
                id: 2,
                name: 'Wall Art',
                image: 'images/product2.jpg',
                description: 'Stylish wall art for your home or office.',
                model: 'models/art.glb'
            },
            // Add more products as needed
        ];

        const productList = document.getElementById('product-list');
        const productDetails = document.getElementById('product-details');
        const productName = document.getElementById('product-name');
        const productImage = document.getElementById('product-image');
        const productDescription = document.getElementById('product-description');
        const viewInArButton = document.getElementById('view-in-ar-button');
        const backButton = document.getElementById('back-button');
        const colorOptions = document.getElementById('color-options');
        const colorGreenButton = document.getElementById('color-green');
        const colorBlackButton = document.getElementById('color-black');
        const colorDefaultButton = document.getElementById('color-default');

        let currentModelPath = '';

        // Display product list dynamically
        products.forEach(product => {
            const li = document.createElement('li');
            li.textContent = product.name;
            li.onclick = () => showProductDetails(product);
            productList.appendChild(li);
        });

        function showProductDetails(product) {
            productName.textContent = product.name;
            productImage.src = product.image;
            productDescription.textContent = product.description;
            currentModelPath = product.model;

            productDetails.classList.remove('hidden');
            productList.classList.add('hidden');
            colorOptions.classList.remove('hidden'); // Show color options
        }

        viewInArButton.onclick = () => {
            // Check if WebXR is supported
            if (navigator.xr && navigator.xr.isSessionSupported) {
                navigator.xr.isSessionSupported('immersive-ar').then((supported) => {
                    if (supported) {
                        // Start WebXR AR session
                        alert("WebXR is supported, but this example uses AR.js for simplicity.");
                    } else {
                        // Fallback to AR.js
                        startARjs();
                    }
                });
            } else {
                // Fallback to AR.js
                startARjs();
            }
        };

        function startARjs() {
            const aScene = document.querySelector('a-scene');
            aScene.style.display = 'block';
            document.querySelector('#model').setAttribute('src', currentModelPath);
        }

        backButton.onclick = () => {
            productDetails.classList.add('hidden');
            productList.classList.remove('hidden');
            colorOptions.classList.add('hidden'); // Hide color options
        };
    </script>
</body>

</html>
